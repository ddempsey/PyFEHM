# elem - Element Connectivity Data

**Status**: REQUIRED if macro **fdm** not used

## Purpose

Element connectivity data. These data are usually created by a mesh generation program, then cut and copied into the input file or a separate geometry data input file.

## Input Format

```
elem
NS  NEI
MB  NELM(1)  NELM(2)  ...  NELM(NS)
...
(blank line to end)
```

## Parameters

### Group 1 - Element Definition

| Variable | Format | Description |
|----------|--------|-------------|
| NS | integer | Number of nodes per element. If NS < 0, code converts rectangles/bricks to triangles/tetrahedrals for stability in nonlinear problems with distorted mesh. |
| NEI | integer | Number of elements |

### Group 2 - Element Nodes (repeated for each element)

| Variable | Format | Description |
|----------|--------|-------------|
| MB | integer | Element number. If MB < 0, intermediate values are generated by interpolation. |
| NELM(1) | integer | First node of element MB |
| NELM(2) | integer | Second node of element MB |
| ... | | ... |
| NELM(NS) | integer | Last node of element MB |

## Element Types

FEHM supports the following element types (see Figure 2 in manual):

### 2-D Elements
- **Quadrilateral** (NS=4): Nodes numbered counter-clockwise starting from lower-left
- **Triangle** (NS=3): Nodes numbered counter-clockwise

### 3-D Elements
- **Brick/Hexahedron** (NS=8): Lower face numbered counter-clockwise, then upper face
- **Tetrahedron** (NS=4): Base triangle counter-clockwise, then apex
- **Prism** (NS=6): Lower triangle counter-clockwise, then upper triangle

## Example

```
elem
    4       117
    1        15        16         2         1
    2        16        17         3         2
    .
    .
   10        24        25        11        10
   11        25        26        12        11
   12        26        27        13        12
    .
    .
  116       138       139       125       124
  117       139       140       126       125

```

In this example:
- 4 nodes per element (2D quadrilaterals)
- 117 total elements
- Element 1 is defined by nodes 15, 16, 2, 1
- Element 2 is defined by nodes 16, 17, 3, 2
- And so on...

## Notes

- A blank line terminates the element input section
- Elements must be consistent with the node coordinates defined in **coor**
- For distorted meshes, using NS < 0 can improve stability
- Modern workflows typically generate element data using mesh generation tools (LaGriT, etc.)
- The **fdm** macro can be used instead for regular finite difference grids
- Node numbering convention follows right-hand rule for positive volume
